<!DOCTYPE html>
<html lang="en">

<head>
    <title>Zay Shop - Product Listing Page</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="../static/img/apple-icon.png">
    <link rel="shortcut icon" type="image/x-icon" href="../static/img/favicon.ico">

    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/templatemo.css">
    <link rel="stylesheet" href="../static/css/custom.css">

    <!-- Load fonts style after rendering the layout styles -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;200;300;400;500;700;900&display=swap">
    <link rel="stylesheet" href="../static/css/fontawesome.min.css">
<!--
    
TemplateMo 559 Zay Shop

https://templatemo.com/tm-559-zay-shop

-->
<style>
        .card-img {
            width: 100%; /* Ensure image fills the width of its container */
            height: 300px; /* Fixed height for all images */
            object-fit: cover; /* Ensures the image covers the area without stretching */
        }
</style>
</head>

<body>
    <!-- Start Top Nav -->
    <nav class="navbar navbar-expand-lg bg-dark navbar-light d-none d-lg-block" id="templatemo_nav_top">
        <div class="container text-light">
            <div class="w-100 d-flex justify-content-between">
                <div>
                    <i class="fa fa-envelope mx-2"></i>
                    <a class="navbar-sm-brand text-light text-decoration-none" href="mailto:info@company.com">info@company.com</a>
                    <i class="fa fa-phone mx-2"></i>
                    <a class="navbar-sm-brand text-light text-decoration-none" href="tel:010-020-0340">010-020-0340</a>
                </div>
                <div>
                    <a class="text-light" href="https://fb.com/templatemo" target="_blank" rel="sponsored"><i class="fab fa-facebook-f fa-sm fa-fw me-2"></i></a>
                    <a class="text-light" href="https://www.instagram.com/" target="_blank"><i class="fab fa-instagram fa-sm fa-fw me-2"></i></a>
                    <a class="text-light" href="https://twitter.com/" target="_blank"><i class="fab fa-twitter fa-sm fa-fw me-2"></i></a>
                    <a class="text-light" href="https://www.linkedin.com/" target="_blank"><i class="fab fa-linkedin fa-sm fa-fw"></i></a>
                </div>
            </div>
        </div>
    </nav>
    <!-- Close Top Nav -->


    <!-- Header -->
    <nav class="navbar navbar-expand-lg navbar-light shadow">
        <div class="container d-flex justify-content-between align-items-center">

            <a class="navbar-brand text-success logo h1 align-self-center" href="index.html">
                Zay
            </a>

            <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse" data-bs-target="#templatemo_main_nav" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="align-self-center collapse navbar-collapse flex-fill  d-lg-flex justify-content-lg-between" id="templatemo_main_nav">
                <div class="flex-fill">
                    <ul class="nav navbar-nav d-flex justify-content-between mx-lg-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('about') }}">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('shop') }}">Shop</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('contact') }}">Contact</a>
                        </li>
                        {% if not session.get('logged_in') %}
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('signupPage') }}">SignUp/Login</a>
                        </li>
                        {% else %}
                        <li class="nav-item">
                           
                            <a class="nav-link" href="{{ url_for('logout') }}">Logout</a>
                        </li>
                       
                        {% endif %}

                        
                    </ul>
                </div>
                <div class="navbar align-self-center d-flex">
                    <!-- <div class="d-lg-none flex-sm-fill mt-3 mb-4 col-7 col-sm-auto pr-3">
                        <div class="input-group">
                            <input type="text" class="form-control" id="inputMobileSearch" placeholder="Search ...">
                            <div class="input-group-text">
                                <i class="fa fa-fw fa-search"></i>
                            </div>
                        </div>
                    </div> -->
                    <!-- <a class="nav-icon d-none d-lg-inline" href="#" data-bs-toggle="modal" data-bs-target="#templatemo_search">
                        <i class="fa fa-fw fa-search text-dark mr-2"></i>
                    </a> -->
                    <a class="nav-icon position-relative text-decoration-none" href="{{ url_for('cart') }}">
                        <i class="fa fa-fw fa-cart-arrow-down text-dark mr-1"></i>
                        <span class="position-absolute top-0 left-100 translate-middle badge rounded-pill bg-light text-dark">7</span>
                    </a>
                    <a class="nav-icon position-relative text-decoration-none" href="{{ url_for('user') }}">
                        <i class="fa fa-fw fa-user text-dark mr-3"></i>
                        <!-- <span class="position-absolute top-0 left-100 translate-middle badge rounded-pill bg-light text-dark">+99</span> -->
                    </a>
                   
                   
                </div>
            </div>

        </div>
    </nav>
    <!-- Close Header -->

    <!-- Modal -->
    <div class="modal fade bg-white" id="templatemo_search" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="w-100 pt-1 mb-5 text-right">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form action="" method="get" class="modal-content modal-body border-0 p-0">
                <div class="input-group mb-2">
                    <input type="text" class="form-control" id="inputModalSearch" name="q" placeholder="Search ...">
                    <button type="submit" class="input-group-text bg-success text-light">
                        <i class="fa fa-fw fa-search text-white"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>



    <!-- Start Content -->
    <div class="container py-5">
        <div class="row justify-content-center">

           

            <div class="col-lg-9" >
                
                <div class="row">
                    {% for product in products %}
                    <div class="col-md-4">
                        <div class="card mb-4 product-wap rounded-0">
                            <div class="card rounded-0">
                                <img class="card-img rounded-0 img-fluid" src="{{ product['image'] }}" alt="{{ product['product_name'] }}">
                            </div>
                            <div class="card-body">
                                <h3 class="text-center">{{ product['product_name'] }}</h3>
                                <p class="text-center">Price: ${{ product['price'] }}</p>
                                <p class="text-center" id="numberQuantity{{ product.product_id }}">Quantity: {{ product['count'] }}</p>
                                <p class="text-center" id="numberPrice{{ product.product_id }}">Total: ${{ product['price'] * product['count'] }}</p>
                                <div class="row justify-content-center">
                                    <div class="col text-center">
                                        <button class="border-success rounded-2" onclick="decrease('{{ product.product_id }}', {{ product['price'] }})">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <span id="Counternumber{{ product.product_id }}" style="margin: 0 15px;">{{ product['count'] }}</span>
                                        <button class="border-success rounded-2" onclick="increase('{{ product.product_id }}', {{ product['price'] }})">
                                            <i class="fas fa-plus"></i>
                                        </button>                                                                              
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                {% endfor %}
                
                </div>
                <!-- <div class="row">
                    <ul class="pagination pagination-lg justify-content-end">
                        <li class="page-item disabled">
                            <a class="page-link active rounded-0 mr-3 shadow-sm border-top-0 border-left-0" href="#" tabindex="-1">1</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link rounded-0 mr-3 shadow-sm border-top-0 border-left-0 text-dark" href="#">2</a>
                        </li>
                        <li class="page-item">
                            <a class="page-link rounded-0 shadow-sm border-top-0 border-left-0 text-dark" href="#">3</a>
                        </li>
                    </ul>
                </div> -->
            </div>

            <div class="container py-5">
                <div class="row py-5">
                    <div class="text-center fs-1 fw-bold" style="margin-bottom: 1em; color:#28a745">Enter the Details To Send</div>
                    <div class="col-md-9 m-auto"    >
                        <div class="row">
                            <div class="form-group col-md-6 mb-3">
                                <label for="from">From</label>
                                <select id="from" name="from" class="form-control mt-1" required>
                                    <!-- <option value="USA">USA</option>
                                    <option value="UK">UK</option>
                                    <option value="RUSSIA">Russia</option>
                                    <option value="GERMANY">Germany</option>
                                    <option value="FRANCE">France</option> -->
                                    <option value="CHENNAI">Chennai</option>
                                    <option value="MUMBAI">Mumbai</option>
                                    <option value="KOLKATA">Kolkata</option>
                                    <option value="DELHI">Delhi</option>
                                    <option value="BANGALORE">Bangalore</option>
                                </select>
                            </div>
                            
                            <div class="form-group col-md-6 mb-3">
                                <label for="to">To</label>
                                <select id="to" name="to" class="form-control mt-1" required>
                                    <option value="USA">USA</option>
                                    <option value="UK">UK</option>
                                    <option value="RUSSIA">Russia</option>
                                    <option value="GERMANY">Germany</option>
                                    <option value="FRANCE">France</option>
                                    <!-- <option value="CHENNAI">Chennai</option>
                                    <option value="MUMBAI">Mumbai</option>
                                    <option value="KOLKATA">Kolkata</option>
                                    <option value="DELHI">Delhi</option>
                                    <option value="BANGALORE">Bangalore</option> -->
                                </select>
                            </div>
                            
                        </div>
                        <div class="row">
                        
                        
                        <div class="form-group mb-3">
                            <label for="deliverydate">Delivery Date</label>
                            <input type="date" id="deliverydate" name="deliverydate" class="form-control mt-1" required>
                        </div>
                        </div>
                        
                        <div class="row">
                            <div class="col text-end mt-2">
                                <button type="submit" class="btn btn-success btn-lg px-3" onclick="validateAndSubmit()">Order Now</button>
                            </div>
                        </div>
                    </div>
                    
                    
                </div>
            </div>

        </div>
    </div>
    <!-- End Content -->

    <!-- Start Brands -->
    <section class="bg-light py-5">
        <div class="container my-4">
            <div class="row text-center py-3">
                <div class="col-lg-6 m-auto">
                    <h1 class="h1">Our Brands</h1>
                    <p>
                        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        Lorem ipsum dolor sit amet.
                    </p>
                </div>
                <div class="col-lg-9 m-auto tempaltemo-carousel">
                    <div class="row d-flex flex-row">
                        <!--Controls-->
                        <div class="col-1 align-self-center">
                            <a class="h1" href="#multi-item-example" role="button" data-bs-slide="prev">
                                <i class="text-light fas fa-chevron-left"></i>
                            </a>
                        </div>
                        <!--End Controls-->

                        <!--Carousel Wrapper-->
                        <div class="col">
                            <div class="carousel slide carousel-multi-item pt-2 pt-md-0" id="multi-item-example" data-bs-ride="carousel">
                                <!--Slides-->
                                <div class="carousel-inner product-links-wap" role="listbox">

                                    <!--First slide-->
                                    <div class="carousel-item active">
                                        <div class="row">
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_01.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_02.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_03.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_04.png" alt="Brand Logo"></a>
                                            </div>
                                        </div>
                                    </div>
                                    <!--End First slide-->

                                    <!--Second slide-->
                                    <div class="carousel-item">
                                        <div class="row">
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_01.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_02.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_03.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_04.png" alt="Brand Logo"></a>
                                            </div>
                                        </div>
                                    </div>
                                    <!--End Second slide-->

                                    <!--Third slide-->
                                    <div class="carousel-item">
                                        <div class="row">
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_01.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_02.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_03.png" alt="Brand Logo"></a>
                                            </div>
                                            <div class="col-3 p-md-5">
                                                <a href="#"><img class="img-fluid brand-img" src="../static/img/brand_04.png" alt="Brand Logo"></a>
                                            </div>
                                        </div>
                                    </div>
                                    <!--End Third slide-->

                                </div>
                                <!--End Slides-->
                            </div>
                        </div>
                        <!--End Carousel Wrapper-->

                        <!--Controls-->
                        <div class="col-1 align-self-center">
                            <a class="h1" href="#multi-item-example" role="button" data-bs-slide="next">
                                <i class="text-light fas fa-chevron-right"></i>
                            </a>
                        </div>
                        <!--End Controls-->
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--End Brands-->


    <!-- Start Footer -->
    <footer class="bg-dark" id="tempaltemo_footer">
        <div class="container">
            <div class="row">

                <div class="col-md-4 pt-5">
                    <h2 class="h2 text-success border-bottom pb-3 border-light logo">Zay Shop</h2>
                    <ul class="list-unstyled text-light footer-link-list">
                        <li>
                            <i class="fas fa-map-marker-alt fa-fw"></i>
                            123 Consectetur at ligula 10660
                        </li>
                        <li>
                            <i class="fa fa-phone fa-fw"></i>
                            <a class="text-decoration-none" href="tel:010-020-0340">010-020-0340</a>
                        </li>
                        <li>
                            <i class="fa fa-envelope fa-fw"></i>
                            <a class="text-decoration-none" href="mailto:info@company.com">info@company.com</a>
                        </li>
                    </ul>
                </div>

                <div class="col-md-4 pt-5">
                    <h2 class="h2 text-light border-bottom pb-3 border-light">Products</h2>
                    <ul class="list-unstyled text-light footer-link-list">
                        <li><a class="text-decoration-none" href="#">Luxury</a></li>
                        <li><a class="text-decoration-none" href="#">Sport Wear</a></li>
                        <li><a class="text-decoration-none" href="#">Men's Shoes</a></li>
                        <li><a class="text-decoration-none" href="#">Women's Shoes</a></li>
                        <li><a class="text-decoration-none" href="#">Popular Dress</a></li>
                        <li><a class="text-decoration-none" href="#">Gym Accessories</a></li>
                        <li><a class="text-decoration-none" href="#">Sport Shoes</a></li>
                    </ul>
                </div>

                <div class="col-md-4 pt-5">
                    <h2 class="h2 text-light border-bottom pb-3 border-light">Further Info</h2>
                    <ul class="list-unstyled text-light footer-link-list">
                        <li><a class="text-decoration-none" href="#">Home</a></li>
                        <li><a class="text-decoration-none" href="#">About Us</a></li>
                        <li><a class="text-decoration-none" href="#">Shop Locations</a></li>
                        <li><a class="text-decoration-none" href="#">FAQs</a></li>
                        <li><a class="text-decoration-none" href="#">Contact</a></li>
                    </ul>
                </div>

            </div>

            <div class="row text-light mb-4">
                <div class="col-12 mb-3">
                    <div class="w-100 my-3 border-top border-light"></div>
                </div>
                <div class="col-auto me-auto">
                    <ul class="list-inline text-left footer-icons">
                        <li class="list-inline-item border border-light rounded-circle text-center">
                            <a class="text-light text-decoration-none" target="_blank" href="http://facebook.com/"><i class="fab fa-facebook-f fa-lg fa-fw"></i></a>
                        </li>
                        <li class="list-inline-item border border-light rounded-circle text-center">
                            <a class="text-light text-decoration-none" target="_blank" href="https://www.instagram.com/"><i class="fab fa-instagram fa-lg fa-fw"></i></a>
                        </li>
                        <li class="list-inline-item border border-light rounded-circle text-center">
                            <a class="text-light text-decoration-none" target="_blank" href="https://twitter.com/"><i class="fab fa-twitter fa-lg fa-fw"></i></a>
                        </li>
                        <li class="list-inline-item border border-light rounded-circle text-center">
                            <a class="text-light text-decoration-none" target="_blank" href="https://www.linkedin.com/"><i class="fab fa-linkedin fa-lg fa-fw"></i></a>
                        </li>
                    </ul>
                </div>
                <div class="col-auto">
                    <label class="sr-only" for="subscribeEmail">Email address</label>
                    <div class="input-group mb-2">
                        <input type="text" class="form-control bg-dark border-light" id="subscribeEmail" placeholder="Email address">
                        <div class="input-group-text btn-success text-light">Subscribe</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="w-100 bg-black py-3">
            <div class="container">
                <div class="row pt-2">
                    <div class="col-12">
                        <p class="text-left text-light">
                            Copyright &copy; 2021 Company Name 
                            | Designed by <a rel="sponsored" href="https://templatemo.com" target="_blank">TemplateMo</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>

    </footer>
    <!-- End Footer -->

    <!-- Start Script -->
    <script src="../static/js/jquery-1.11.0.min.js"></script>
    <script src="../static/js/jquery-migrate-1.2.1.min.js"></script>
    <script src="../static/js/bootstrap.bundle.min.js"></script>
    <script src="../static/js/templatemo.js"></script>
    <script src="../static/js/custom.js"></script>
    <script>
const count = {};
const url = '/update-count'; // Your backend endpoint
function increase(productId, price) {
    displayedCount = document.getElementById(`Counternumber${productId}`).textContent;
    displayedCount = Number(displayedCount);
    displayedCount += 1

    document.getElementById(`Counternumber${productId}`).textContent = displayedCount;
    document.getElementById(`numberQuantity${productId}`).textContent =  `Quantity: ${displayedCount}`;  
    let amount = price * displayedCount;
    document.getElementById(`numberPrice${productId}`).textContent = `Total: $ ${amount}.00`;
    // Send the updated count to the backend
    updateDatabase(productId, displayedCount);
}

function decrease(productId, price) {
    displayedCount = document.getElementById(`Counternumber${productId}`).textContent;
    displayedCount = Number(displayedCount);
   
    if (displayedCount > 0) displayedCount -= 1;

    document.getElementById(`Counternumber${productId}`).textContent = displayedCount;
    document.getElementById(`numberQuantity${productId}`).textContent = `Quantity: ${displayedCount}`;
    let amount = price * displayedCount;
    document.getElementById(`numberPrice${productId}`).textContent = `Total: $ ${amount}.00`;
    // Send the updated count to the backend
    updateDatabase(productId, displayedCount);
}

function updateDatabase(productId, updatedCount) {
    fetch(url, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            product_id: productId,
            count: updatedCount
        }),
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            console.log('Database updated successfully.');
        } else {
            console.error('Error updating database:', data.error);
        }
    })
    .catch(error => console.error('Network error:', error));
}


// function updateDatabase(productId, updatedCount) {
//     fetch(url, {
//         method: 'POST',
//         headers: {
//             'Content-Type': 'application/json',
//         },
//         body: JSON.stringify({
//             product_id: productId,
//             count: updatedCount
//         }),
//     })
//     .then(response => response.json())
//     .then(data => {
//         if (data.success) {
//             console.log('Database updated successfully.');
//         } else {
//             console.error('Error updating database:', data.error);
//         }
//         })
//         .catch(error => console.error('Network error:', error));
//     }

    // FORM SUBMIT

    function validateAndSubmit() {
    // Get form elements
    const from = document.getElementById("from").value;
    const to = document.getElementById("to").value;
    const deliveryDate = document.getElementById("deliverydate").value;
    const today = new Date();
    const delivery = new Date(deliveryDate);

    // Validate the 'From' and 'To' fields
    if (from === to) {
        alert("The 'From' and 'To' locations cannot be the same.");
        return false; // Prevent form submission
    }

    // Validate the delivery date
    const timeDifference = delivery.getTime() - today.getTime();
    const daysDifference = timeDifference / (1000 * 3600 * 24); // Convert to days

    if (daysDifference < 5) {
        alert("The delivery date must be at least 5 days from today.");
        return false; // Prevent form submission
    }

    // Calculate the total price
    let totalPrice = 0;
    const productElements = document.querySelectorAll("[id^='numberPrice']");
    productElements.forEach(productElement => {
        const priceText = productElement.textContent;
        const price = parseFloat(priceText.replace("Total: $", "")); // Extract numeric value
        totalPrice += price;
    });

    // Log total price for debugging
    console.log("Total Price:", totalPrice);

    // Collect all the form data using querySelector
    const formData = {
        from: document.querySelector("#from").value,
        to: document.querySelector("#to").value,
        deliverydate: document.querySelector("#deliverydate").value,
        total_price: totalPrice,
        today_date: today.toISOString().split("T")[0] // Current date in YYYY-MM-DD format
    };

      // Check if the cart is empty
      if (totalPrice === 0) {
        alert("Your cart is empty. You cannot place an order.");
        return false; // Prevent form submission
    }
    // Log the collected data for debugging
    console.log("FormData contents:", formData);

    // Send the data to the backend using fetch
    fetch("/yourDetails", {
        method: "POST",
        headers: {
            "Content-Type": "application/json" // Set the content type to JSON
        },
        body: JSON.stringify(formData) // Convert formData object to JSON string
    })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Redirect or show success message
                alert("Order placed successfully!");
                window.location.href = "/shop"; // Redirect as needed
            } else {
                alert("Error placing order.");
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("An error occurred while placing your order.");
        });

    return false; // Prevent form from submitting traditionally
}

    </script>
    <!-- End Script -->
</body>

</html>